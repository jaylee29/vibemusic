<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Music ¬∑ Local Audio ¬∑ Kumpletong Lyrics</title>
    <style>
        /* ========== EXACT DESIGN (no changes) ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s, transform 0.2s, box-shadow 0.2s;
        }
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: #1a1a24;
            --bg-card-hover: #22222f;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --accent-primary: #8a2be2;
            --accent-secondary: #4a00e0;
            --accent-tertiary: #00d4ff;
            --accent-glow: rgba(138, 43, 226, 0.4);
            --accent-gradient: linear-gradient(135deg, #8a2be2, #4a00e0, #00d4ff);
            --border-color: #2a2a35;
            --shadow-color: rgba(0, 0, 0, 0.5);
            --input-bg: #22222a;
            --hover-bg: #2a2a35;
            --lyrics-highlight: #8a2be2;
            --lyrics-bg: rgba(138, 43, 226, 0.15);
            --player-bg: rgba(18, 18, 26, 0.95);
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --hover-shadow: 0 20px 40px rgba(138, 43, 226, 0.3);
        }
        [data-theme="light"] {
            --bg-primary: #f0f2f5;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --bg-card-hover: #f8f9fa;
            --text-primary: #1a1a2a;
            --text-secondary: #4a4a6a;
            --accent-primary: #8a2be2;
            --accent-secondary: #6f42c1;
            --accent-tertiary: #0099ff;
            --accent-glow: rgba(138, 43, 226, 0.2);
            --accent-gradient: linear-gradient(135deg, #8a2be2, #6f42c1, #0099ff);
            --border-color: #e0e0f0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --input-bg: #f5f5fa;
            --hover-bg: #f0f0fa;
            --lyrics-highlight: #8a2be2;
            --lyrics-bg: rgba(138, 43, 226, 0.08);
            --player-bg: rgba(255, 255, 255, 0.95);
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --hover-shadow: 0 20px 40px rgba(138, 43, 226, 0.15);
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        #app { max-width: 1600px; margin: 0 auto; padding: 20px; padding-bottom: 120px; position: relative; }
        .animated-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; background: var(--bg-primary); }
        .gradient-sphere { position: absolute; width: 800px; height: 800px; background: var(--accent-gradient); border-radius: 50%; filter: blur(150px); opacity: 0.15; animation: sphereMove 30s ease-in-out infinite; top: -400px; right: -200px; }
        .gradient-sphere-2 { position: absolute; width: 600px; height: 600px; background: linear-gradient(135deg, var(--accent-tertiary), var(--accent-primary)); border-radius: 50%; filter: blur(120px); opacity: 0.1; animation: sphereMove2 25s ease-in-out infinite; bottom: -300px; left: -200px; }
        @keyframes sphereMove { 0%,100%{transform:translate(0,0) scale(1);} 33%{transform:translate(100px,100px) scale(1.1);} 66%{transform:translate(-50px,50px) scale(0.9);} }
        @keyframes sphereMove2 { 0%,100%{transform:translate(0,0) scale(1);} 33%{transform:translate(-100px,-50px) scale(1.2);} 66%{transform:translate(50px,-100px) scale(0.8);} }
        .particles { position: fixed; top:0; left:0; width:100%; height:100%; z-index:-1; pointer-events:none; }
        .particle { position:absolute; background:var(--accent-primary); border-radius:50%; opacity:0.1; animation:float 20s infinite linear; }
        @keyframes float { 0%{transform:translateY(100vh) translateX(-100px) rotate(0deg);opacity:0;} 10%{opacity:0.2;} 90%{opacity:0.2;} 100%{transform:translateY(-100px) translateX(100px) rotate(360deg);opacity:0;} }
        #auth-section { display:flex; justify-content:center; align-items:center; min-height:100vh; perspective:1000px; padding:20px; }
        .auth-container { background:var(--bg-card); padding:50px 40px; border-radius:40px; width:100%; max-width:480px; transform-style:preserve-3d; animation:floatIn3D 1s ease-out; box-shadow:0 40px 80px rgba(0,0,0,0.4),0 0 0 2px var(--accent-glow),inset 0 0 40px var(--accent-glow); backdrop-filter:blur(20px); border:1px solid rgba(138,43,226,0.3); z-index:10; }
        @keyframes floatIn3D { 0%{opacity:0; transform:translateY(100px) rotateX(-20deg) scale(0.8);} 100%{opacity:1; transform:translateY(0) rotateX(0) scale(1);} }
        .auth-container::before { content:''; position:absolute; top:-3px; left:-3px; right:-3px; bottom:-3px; background:var(--accent-gradient); border-radius:42px; z-index:-1; animation:borderPulse 3s ease-in-out infinite; opacity:0.5; }
        @keyframes borderPulse { 0%,100%{filter:blur(15px); opacity:0.5;} 50%{filter:blur(25px); opacity:0.8;} }
        .auth-container::after { content:''; position:absolute; top:0; left:0; right:0; height:100px; background:linear-gradient(to bottom, rgba(138,43,226,0.2), transparent); border-radius:40px 40px 0 0; pointer-events:none; }
        .auth-container h2 { margin-bottom:30px; text-align:center; font-size:48px; font-weight:800; letter-spacing:3px; text-transform:uppercase; background:var(--accent-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; text-shadow:0 0 30px var(--accent-glow); transform:translateZ(30px); position:relative; }
        .auth-container h2::after { content:'‚ú®'; position:absolute; font-size:24px; margin-left:10px; animation:starGlow 2s ease-in-out infinite; }
        @keyframes starGlow { 0%,100%{opacity:0.5; transform:scale(1);} 50%{opacity:1; transform:scale(1.2);} }
        .auth-tabs { display:flex; margin-bottom:40px; background:var(--bg-primary); border-radius:60px; padding:8px; border:1px solid var(--accent-primary); }
        .auth-tab { flex:1; padding:15px 20px; background:none; border:none; color:var(--text-secondary); cursor:pointer; font-size:18px; font-weight:700; border-radius:60px; letter-spacing:1px; }
        .auth-tab.active { color:white; }
        .auth-tab.active::before { content:''; position:absolute; top:0; left:0; right:0; bottom:0; background:var(--accent-gradient); border-radius:60px; z-index:-1; animation:tabGlow 2s infinite; box-shadow:0 5px 20px var(--accent-glow); }
        .auth-form { display:none; }
        .auth-form.active { display:block; animation:slideInForm 0.6s cubic-bezier(0.175,0.885,0.32,1.275); }
        @keyframes slideInForm { 0%{opacity:0; transform:translateX(-30px) rotateY(-10deg);} 100%{opacity:1; transform:translateX(0) rotateY(0);} }
        .form-group { margin-bottom:25px; }
        .form-group label { display:block; margin-bottom:10px; color:var(--text-secondary); font-weight:600; padding-left:10px; }
        .input-wrapper { position:relative; }
        .input-icon { position:absolute; left:20px; top:50%; transform:translateY(-50%); font-size:20px; z-index:2; filter:drop-shadow(0 0 5px var(--accent-glow)); }
        .form-group input { width:100%; padding:18px 20px 18px 55px; background:var(--input-bg); border:2px solid transparent; border-radius:30px; color:var(--text-primary); font-size:16px; transition:all 0.4s; box-shadow:0 10px 30px rgba(0,0,0,0.2); }
        .form-group input:focus { outline:none; border-color:var(--accent-primary); box-shadow:0 0 40px var(--accent-glow); transform:translateZ(20px) scale(1.02); background:var(--bg-card); }
        .btn { width:100%; padding:18px; background:var(--accent-gradient); color:white; border:none; border-radius:40px; font-size:20px; font-weight:800; cursor:pointer; transition:all 0.4s; overflow:hidden; box-shadow:0 15px 40px var(--accent-glow); letter-spacing:2px; margin-top:20px; }
        .btn:hover { transform:scale(1.05); box-shadow:0 25px 50px var(--accent-glow); }
        .error-message { color:#ff4444; font-size:14px; margin-top:15px; text-align:center; font-weight:600; padding:10px; background:rgba(255,68,68,0.1); border-radius:30px; border:1px solid rgba(255,68,68,0.3); }
        #main-app { display:none; animation:fadeInUp 1s ease-out; }
        @keyframes fadeInUp { from{opacity:0; transform:translateY(30px);} to{opacity:1; transform:translateY(0);} }
        .app-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:30px; padding:20px 30px; background:var(--bg-card); border-radius:30px; box-shadow:var(--card-shadow); backdrop-filter:blur(10px); border:1px solid rgba(138,43,226,0.2); }
        .app-title h1 { font-size:36px; font-weight:800; background:var(--accent-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        .welcome-badge { display:inline-block; padding:5px 15px; background:var(--bg-card-hover); border-radius:30px; font-size:14px; color:var(--text-secondary); border:1px solid var(--accent-primary); }
        .glass-btn { padding:12px 25px; background:var(--bg-primary); color:var(--text-primary); border:1px solid var(--accent-primary); border-radius:30px; cursor:pointer; font-weight:600; backdrop-filter:blur(5px); display:flex; align-items:center; gap:8px; }
        .glass-btn:hover { background:var(--accent-primary); color:white; box-shadow:0 10px 25px var(--accent-glow); }
        .search-section { margin-bottom:30px; }
        .search-wrapper { position:relative; max-width:600px; margin:0 auto; }
        .search-icon { position:absolute; left:20px; top:50%; transform:translateY(-50%); font-size:20px; color:var(--accent-primary); }
        .search-input { width:100%; padding:18px 20px 18px 55px; background:var(--bg-card); border:2px solid transparent; border-radius:50px; color:var(--text-primary); font-size:16px; box-shadow:var(--card-shadow); }
        .search-input:focus { outline:none; border-color:var(--accent-primary); box-shadow:0 0 30px var(--accent-glow); transform:scale(1.02); }
        .section-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
        .section-title { font-size:24px; font-weight:700; background:var(--accent-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; position:relative; }
        .section-title::after { content:''; position:absolute; bottom:-5px; left:0; width:50%; height:3px; background:var(--accent-gradient); border-radius:3px; }
        .view-all { color:var(--accent-primary); font-weight:600; padding:8px 15px; border-radius:30px; background:var(--bg-card); border:1px solid var(--accent-primary); transition:all 0.3s; font-size:14px; text-decoration:none; }
        .view-all:hover { background:var(--accent-primary); color:white; }
        .songs-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)); gap:25px; }
        .song-card { background:var(--bg-card); border-radius:25px; padding:20px; transition:all 0.4s cubic-bezier(0.175,0.885,0.32,1.275); cursor:pointer; border:1px solid rgba(138,43,226,0.1); box-shadow:var(--card-shadow); backdrop-filter:blur(10px); }
        .song-card:hover { transform:translateY(-10px) scale(1.02); box-shadow:var(--hover-shadow); border-color:var(--accent-primary); }
        .song-card.playing { border:2px solid var(--accent-primary); animation:cardPulse 2s infinite; }
        @keyframes cardPulse { 0%,100%{box-shadow:0 0 20px var(--accent-glow);} 50%{box-shadow:0 0 40px var(--accent-glow);} }
        .song-thumbnail { width:100%; aspect-ratio:1; border-radius:20px; margin-bottom:15px; background-size:cover; background-position:center; position:relative; overflow:hidden; box-shadow:0 10px 20px rgba(0,0,0,0.3); }
        .play-overlay { position:absolute; top:0; left:0; right:0; bottom:0; background:linear-gradient(135deg, rgba(138,43,226,0.8), rgba(74,0,224,0.8)); display:flex; align-items:center; justify-content:center; opacity:0; transition:all 0.4s; border-radius:20px; backdrop-filter:blur(5px); }
        .song-card:hover .play-overlay { opacity:1; }
        .play-overlay span { font-size:60px; color:white; filter:drop-shadow(0 0 20px rgba(255,255,255,0.5)); }
        .song-title { font-weight:700; margin-bottom:5px; font-size:16px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .song-artist { color:var(--text-secondary); font-size:14px; margin-bottom:15px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .song-actions { display:flex; gap:8px; }
        .song-btn { flex:1; padding:10px; border:none; border-radius:15px; font-size:12px; font-weight:600; cursor:pointer; transition:all 0.3s; background:var(--accent-primary); color:white; box-shadow:0 5px 15px var(--accent-glow); }
        .song-btn.secondary { background:var(--bg-card-hover); color:var(--text-primary); border:1px solid var(--accent-primary); }
        .song-btn.secondary:hover { background:var(--accent-primary); color:white; }
        .lyrics-section { background:var(--bg-card); border-radius:40px; padding:40px; margin:40px 0; box-shadow:var(--card-shadow); border:1px solid rgba(138,43,226,0.2); backdrop-filter:blur(10px); position:relative; }
        .lyrics-container { max-height:500px; overflow-y:auto; padding:20px; scroll-behavior:smooth; }
        .lyric-line { font-size:28px; text-align:center; padding:25px; border-radius:30px; transition:all 0.4s; opacity:0.3; transform:scale(0.95); cursor:pointer; color:var(--text-secondary); line-height:1.6; font-weight:500; margin:10px 0; }
        .lyric-line:hover { opacity:0.6; background:var(--hover-bg); transform:scale(1); }
        .lyric-line.active { opacity:1; transform:scale(1.05); color:var(--lyrics-highlight); font-weight:700; text-shadow:0 0 30px var(--accent-glow); background:var(--lyrics-bg); box-shadow:0 20px 40px var(--accent-glow); }
        .no-lyrics { text-align:center; color:var(--text-secondary); font-style:italic; padding:50px; font-size:18px; }
        .offline-section { margin-top:30px; background:var(--bg-card); border-radius:15px; padding:20px; }
        .stats-section { background:var(--bg-card); border-radius:40px; padding:40px; margin:40px 0; box-shadow:var(--card-shadow); border:1px solid rgba(138,43,226,0.2); }
        .stats-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px,1fr)); gap:25px; margin:30px 0; }
        .stat-card { background:var(--bg-card-hover); padding:30px; border-radius:30px; text-align:center; border:1px solid var(--accent-primary); overflow:hidden; }
        .stat-value { font-size:42px; font-weight:800; background:var(--accent-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:10px; }
        .stat-label { color:var(--text-secondary); font-size:16px; font-weight:500; }
        .artist-list { background:var(--bg-card-hover); border-radius:30px; padding:20px; margin-top:20px; }
        .artist-item { display:flex; justify-content:space-between; padding:15px 20px; border-bottom:1px solid var(--border-color); border-radius:15px; }
        .artist-item:hover { background:var(--accent-glow); transform:translateX(10px); }
        .artist-item span:first-child { font-weight:600; color:var(--accent-primary); }
        .artist-item span:last-child { background:var(--accent-primary); color:white; padding:5px 15px; border-radius:30px; font-weight:600; font-size:14px; }
        .music-player { position:fixed; bottom:20px; left:20px; right:20px; background:var(--player-bg); padding:20px 30px; border-radius:60px; box-shadow:0 20px 40px var(--shadow-color),0 0 0 2px var(--accent-glow),inset 0 0 30px var(--accent-glow); display:flex; align-items:center; gap:30px; z-index:1000; backdrop-filter:blur(20px); border:1px solid rgba(138,43,226,0.3); animation:slideUpPlayer 1s ease-out; }
        @keyframes slideUpPlayer { from{opacity:0; transform:translateY(100px);} to{opacity:1; transform:translateY(0);} }
        .player-info { min-width:250px; }
        .now-playing-title { font-weight:700; font-size:18px; color:var(--accent-primary); margin-bottom:5px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .now-playing-artist { color:var(--text-secondary); font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
        .player-controls { display:flex; gap:20px; align-items:center; }
        .control-btn { background:none; border:none; color:var(--text-primary); font-size:24px; cursor:pointer; padding:12px; border-radius:50%; width:50px; height:50px; display:flex; align-items:center; justify-content:center; }
        .control-btn:hover { color:white; transform:scale(1.2); background:var(--accent-gradient); }
        .control-btn.play-pause { background:var(--accent-gradient); color:white; width:60px; height:60px; font-size:28px; box-shadow:0 0 30px var(--accent-glow); }
        .progress-container { flex:1; display:flex; align-items:center; gap:15px; }
        .time-display { color:var(--text-secondary); font-size:14px; font-weight:600; min-width:45px; }
        .progress-bar { flex:1; height:6px; background:var(--border-color); border-radius:10px; cursor:pointer; position:relative; overflow:hidden; }
        .progress { height:100%; background:var(--accent-gradient); border-radius:10px; width:0%; transition:width 0.1s linear; }
        .volume-control { display:flex; align-items:center; gap:10px; min-width:150px; }
        .volume-slider { width:100px; height:4px; background:var(--border-color); border-radius:5px; -webkit-appearance:none; }
        .volume-slider::-webkit-slider-thumb { -webkit-appearance:none; width:15px; height:15px; background:var(--accent-gradient); border-radius:50%; cursor:pointer; box-shadow:0 0 10px var(--accent-glow); }
        .lyrics-toggle { position:fixed; bottom:120px; right:30px; background:var(--accent-gradient); color:white; border:none; border-radius:60px; padding:18px 30px; font-size:16px; font-weight:700; cursor:pointer; box-shadow:0 10px 30px var(--accent-glow); z-index:999; backdrop-filter:blur(10px); display:flex; align-items:center; gap:10px; animation:pulseButton 2s infinite; }
        .lyrics-toggle.active { background:var(--bg-card); color:var(--accent-primary); border:2px solid var(--accent-primary); }
        @keyframes pulseButton { 0%,100%{box-shadow:0 10px 30px var(--accent-glow);} 50%{box-shadow:0 20px 50px var(--accent-glow); transform:scale(1.05);} }
        .notification { position:fixed; top:30px; right:30px; background:var(--accent-gradient); color:white; padding:20px 30px; border-radius:60px; box-shadow:0 20px 40px var(--shadow-color); animation:notificationSlide 0.5s cubic-bezier(0.175,0.885,0.32,1.275); z-index:2000; font-weight:600; backdrop-filter:blur(10px); display:flex; align-items:center; gap:10px; }
        @keyframes notificationSlide { 0%{opacity:0; transform:translateX(100px) scale(0.5);} 70%{transform:translateX(-10px) scale(1.05);} 100%{opacity:1; transform:translateX(0) scale(1);} }
        ::-webkit-scrollbar { width:12px; }
        ::-webkit-scrollbar-track { background:var(--bg-primary); border-radius:10px; }
        ::-webkit-scrollbar-thumb { background:var(--accent-gradient); border-radius:10px; border:3px solid var(--bg-primary); }
    </style>
</head>
<body>
    <div class="animated-bg"><div class="gradient-sphere"></div><div class="gradient-sphere-2"></div></div>
    <div class="particles" id="particles"></div>
    <div id="app">
        <!-- AUTH SECTION (identical) -->
        <div id="auth-section">
            <div class="auth-container">
                <h2>VIBE MUSIC</h2>
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                    <button class="auth-tab" onclick="switchAuthTab('register')">Register</button>
                </div>
                <div id="login-form" class="auth-form active">
                    <div class="form-group"><label>üìß Email Address</label><div class="input-wrapper"><span class="input-icon">üìß</span><input type="email" id="login-email" placeholder="Enter your email"></div></div>
                    <div class="form-group"><label>üîí Password</label><div class="input-wrapper"><span class="input-icon">üîí</span><input type="password" id="login-password" placeholder="Enter your password"></div></div>
                    <button class="btn" onclick="handleLogin()">Login Now üöÄ</button>
                    <div id="login-error" class="error-message"></div>
                </div>
                <div id="register-form" class="auth-form">
                    <div class="form-group"><label>üë§ Full Name</label><div class="input-wrapper"><span class="input-icon">üë§</span><input type="text" id="register-name" placeholder="Enter your name"></div></div>
                    <div class="form-group"><label>üìß Email Address</label><div class="input-wrapper"><span class="input-icon">üìß</span><input type="email" id="register-email" placeholder="Enter your email"></div></div>
                    <div class="form-group"><label>üîí Password</label><div class="input-wrapper"><span class="input-icon">üîí</span><input type="password" id="register-password" placeholder="Enter your password (min. 6 characters)"></div></div>
                    <button class="btn" onclick="handleRegister()">Create Account ‚ú®</button>
                    <div id="register-error" class="error-message"></div>
                </div>
            </div>
        </div>
        <!-- MAIN APP -->
        <div id="main-app">
            <header class="app-header">
                <div class="app-title"><h1>VIBE MUSIC</h1><span class="welcome-badge" id="welcome-user"></span></div>
                <div class="app-controls"><button class="glass-btn" onclick="toggleTheme()"><span>üé®</span> Theme</button><button class="glass-btn" onclick="handleLogout()"><span>üö™</span> Logout</button></div>
            </header>
            <div class="search-section"><div class="search-wrapper"><span class="search-icon">üîç</span><input type="text" class="search-input" placeholder="Search songs, artists, albums..." oninput="searchSongs(this.value)" id="search-input"></div></div>
            <div class="main-content">
                <div class="library-section"><div class="section-header"><h3 class="section-title">üéµ Music Library</h3><a href="#" class="view-all" onclick="showAllSongs()">View All ‚Üí</a></div><div id="songs-container" class="songs-grid"></div></div>
                <div class="playlist-section"><div class="section-header"><h3 class="section-title">üìã My Playlist</h3><a href="#" class="view-all" onclick="showAllPlaylist()">View All ‚Üí</a></div><div id="playlist-container" class="songs-grid"></div></div>
            </div>
            <div id="lyrics-section" class="lyrics-section" style="display: none;"><div class="section-header"><h3 class="section-title">üìù Lyrics</h3></div><div id="lyrics-container" class="lyrics-container"><div class="no-lyrics">‚ú® Select a song to view lyrics ‚ú®</div></div></div>
            <div class="offline-section"><div class="section-header"><h3 class="section-title">üì• Saved Offline</h3><a href="#" class="view-all" onclick="showAllOffline()">View All ‚Üí</a></div><div id="offline-container" class="songs-grid"></div></div>
            <div class="stats-section"><div class="section-header"><h3 class="section-title">üìä Artist Statistics</h3></div><div class="stats-grid"><div class="stat-card"><div class="stat-value" id="most-played-artist">-</div><div class="stat-label">Most Played Artist</div></div><div class="stat-card"><div class="stat-value" id="total-listens">0</div><div class="stat-label">Total Listens</div></div><div class="stat-card"><div class="stat-value" id="listening-time">0 min</div><div class="stat-label">Listening Time</div></div></div><div id="artist-ranking" class="artist-list"></div></div>
            <audio id="audio-player" preload="metadata" style="display: none;"></audio>
            <button class="lyrics-toggle" onclick="toggleLyrics()" id="lyrics-toggle-btn"><span>üìú</span> Show Lyrics</button>
            <div class="music-player">
                <div class="player-info"><div class="now-playing-title" id="current-song-title">Not Playing</div><div class="now-playing-artist" id="current-song-artist"></div></div>
                <div class="player-controls">
                    <button class="control-btn" onclick="toggleShuffle()" id="shuffle-btn">üîÄ</button>
                    <button class="control-btn" onclick="playPrevious()">‚èÆÔ∏è</button>
                    <button class="control-btn play-pause" onclick="togglePlay()" id="play-pause-btn">‚ñ∂Ô∏è</button>
                    <button class="control-btn" onclick="playNext()">‚è≠Ô∏è</button>
                    <button class="control-btn" onclick="toggleRepeat()" id="repeat-btn">üîÅ</button>
                </div>
                <div class="progress-container">
                    <span class="time-display" id="current-time">0:00</span>
                    <div class="progress-bar" onclick="seekTo(event)"><div class="progress" id="progress-bar"></div></div>
                    <span class="time-display" id="duration">0:00</span>
                </div>
                <div class="volume-control"><span>üîä</span><input type="range" class="volume-slider" min="0" max="100" value="70" oninput="changeVolume(this.value)" id="volume-slider"></div>
            </div>
        </div>
    </div>
    <script>
        (function() {
            // particles
            function createParticles() {
                const p = document.getElementById('particles');
                if(!p) return;
                for(let i=0;i<30;i++) {
                    const part = document.createElement('div');
                    part.className='particle';
                    part.style.left=Math.random()*100+'%';
                    part.style.animationDelay=Math.random()*20+'s';
                    part.style.animationDuration=15+Math.random()*15+'s';
                    part.style.width=Math.random()*8+2+'px';
                    part.style.height=part.style.width;
                    part.style.background='linear-gradient(135deg, var(--accent-primary), var(--accent-tertiary))';
                    p.appendChild(part);
                }
            }
            createParticles();

            // ---------- KUMPLETO AT ON-POINT NA LYRICS (lahat ng kanta) ----------
            const SONGS = [
                { // Uptown Funk
                    filename: 'uptown-funk.mp3',
                    title: 'Uptown Funk',
                    artist: 'Mark Ronson ft. Bruno Mars',
                    thumbnail: 'https://img.youtube.com/vi/OPf0YbXqDm0/maxresdefault.jpg',
                    lyrics: [
                        { time: 0, text: "This hit, that ice cold" },
                        { time: 3, text: "Michelle Pfeiffer, that white gold" },
                        { time: 6, text: "This one for them hood girls" },
                        { time: 9, text: "Them good girls, straight masterpieces" },
                        { time: 12, text: "Styling, while in, living it up in the city" },
                        { time: 15, text: "Got Chucks on with Saint Laurent" },
                        { time: 18, text: "Gotta kiss myself, I'm so pretty" },
                        { time: 21, text: "I'm too hot (hot damn)" },
                        { time: 24, text: "Called a police and a fireman" },
                        { time: 27, text: "I'm too hot (hot damn)" },
                        { time: 30, text: "Make a dragon wanna retire man" },
                        { time: 33, text: "I'm too hot (hot damn)" },
                        { time: 36, text: "Say my name you know who I am" },
                        { time: 39, text: "I'm too hot (hot damn)" },
                        { time: 42, text: "And my band 'bout that money, break it down" },
                        { time: 45, text: "Girls hit your hallelujah (woo)" },
                        { time: 48, text: "Girls hit your hallelujah (woo)" },
                        { time: 51, text: "Girls hit your hallelujah (woo)" },
                        { time: 54, text: "'Cause Uptown Funk gon' give it to you" },
                        { time: 57, text: "'Cause Uptown Funk gon' give it to you" },
                        { time: 60, text: "'Cause Uptown Funk gon' give it to you" },
                        { time: 63, text: "Saturday night and we in the spot" },
                        { time: 66, text: "Don't believe me, just watch (come on)" }
                    ]
                },
                { // Never Gonna Give You Up
                    filename: 'never-gonna-give-you-up.mp3',
                    title: 'Never Gonna Give You Up',
                    artist: 'Rick Astley',
                    thumbnail: 'https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg',
                    lyrics: [
                        { time: 0, text: "We're no strangers to love" },
                        { time: 3, text: "You know the rules and so do I" },
                        { time: 6, text: "A full commitment's what I'm thinking of" },
                        { time: 9, text: "You wouldn't get this from any other guy" },
                        { time: 12, text: "I just wanna tell you how I'm feeling" },
                        { time: 15, text: "Gotta make you understand" },
                        { time: 18, text: "Never gonna give you up" },
                        { time: 21, text: "Never gonna let you down" },
                        { time: 24, text: "Never gonna run around and desert you" },
                        { time: 27, text: "Never gonna make you cry" },
                        { time: 30, text: "Never gonna say goodbye" },
                        { time: 33, text: "Never gonna tell a lie and hurt you" }
                    ]
                },
                { // Shape of You (kumpletong verses hanggang kaya ng MP3)
                    filename: 'shape-of-you.mp3',
                    title: 'Shape of You',
                    artist: 'Ed Sheeran',
                    thumbnail: 'https://img.youtube.com/vi/hT_nvWreIhg/maxresdefault.jpg',
                    lyrics: [
                        { time: 0, text: "The club isn't the best place to find a lover" },
                        { time: 3, text: "So the bar is where I go" },
                        { time: 6, text: "Me and my friends at the table doing shots" },
                        { time: 9, text: "Drinking fast and then we talk slow" },
                        { time: 12, text: "And you come over and start up a conversation with just me" },
                        { time: 15, text: "And trust me I'll give it a chance now" },
                        { time: 18, text: "Take my hand, stop, put Van The Man on the jukebox" },
                        { time: 21, text: "And then we start to dance, and now I'm singing like" },
                        { time: 24, text: "Girl, you know I want your love" },
                        { time: 27, text: "Your love was handmade for somebody like me" },
                        { time: 30, text: "Come on now, follow my lead" },
                        { time: 33, text: "I may be crazy, don't mind me" },
                        { time: 36, text: "Say, boy, let's not talk too much" },
                        { time: 39, text: "Grab on my waist and put that body on me" },
                        { time: 42, text: "Come on now, follow my lead" },
                        { time: 45, text: "Come, come on now, follow my lead" }
                    ]
                },
                { // Despacito (tamang linya)
                    filename: 'despacito.mp3',
                    title: 'Despacito',
                    artist: 'Luis Fonsi ft. Daddy Yankee',
                    thumbnail: 'https://img.youtube.com/vi/kJQP7kiw5Fk/maxresdefault.jpg',
                    lyrics: [
                        { time: 0, text: "¬°Ay!" },
                        { time: 2, text: "Fonsi, DY" },
                        { time: 4, text: "Oh, oh no, oh no" },
                        { time: 6, text: "Oh, yeah" },
                        { time: 8, text: "Diridiri, dirididi Daddy" },
                        { time: 10, text: "Go!" },
                        { time: 12, text: "S√≠, sabes que ya llevo un rato mir√°ndote" },
                        { time: 15, text: "Tengo que bailar contigo hoy (DY)" },
                        { time: 18, text: "Vi que tu mirada ya estaba llam√°ndome" },
                        { time: 21, text: "Mu√©strame el camino que yo voy" },
                        { time: 24, text: "Oh, t√∫, t√∫ eres el im√°n y yo soy el metal" },
                        { time: 27, text: "Me voy acercando y voy armando el plan" },
                        { time: 30, text: "Solo con pensarlo se acelera el pulso" },
                        { time: 33, text: "Ya, ya me est√° gustando m√°s de lo normal" },
                        { time: 36, text: "Todos mis sentidos van pidiendo m√°s" },
                        { time: 39, text: "Esto hay que tomarlo sin ning√∫n apuro" },
                        { time: 42, text: "Despacito" },
                        { time: 45, text: "Quiero respirar tu cuello despacito" },
                        { time: 48, text: "Deja que te diga cosas al o√≠do" },
                        { time: 51, text: "Para que te acuerdes si no est√°s conmigo" }
                    ]
                },
                { // Shallow (buong first verse + chorus)
                    filename: 'shallow.mp3',
                    title: 'Shallow',
                    artist: 'Lady Gaga & Bradley Cooper',
                    thumbnail: 'https://img.youtube.com/vi/pRpeEdMmmQ0/maxresdefault.jpg',
                    lyrics: [
                        { time: 0, text: "Tell me something, girl" },
                        { time: 3, text: "Are you happy in this modern world?" },
                        { time: 6, text: "Or do you need more?" },
                        { time: 9, text: "Is there something else you're searching for?" },
                        { time: 12, text: "I'm falling" },
                        { time: 15, text: "In all the good times I find myself" },
                        { time: 18, text: "Longing for change" },
                        { time: 21, text: "In the bad times I fear myself" },
                        { time: 24, text: "I'm off the deep end, watch as I dive in" },
                        { time: 27, text: "I'll never meet the ground" },
                        { time: 30, text: "Crash through the surface, where they can't hurt us" },
                        { time: 33, text: "We're far from the shallow now" }
                    ]
                }
            ];

            // ---------- STATE ----------
            let currentUser = null;
            let currentSongIndex = 0;
            let isPlaying = false;
            let shuffleMode = false;
            let repeatMode = false;
            let searchQuery = '';
            let showLyrics = false;
            let lyricsUpdateInterval;
            const audio = document.getElementById('audio-player');

            // ---------- AUTH (unchanged) ----------
            window.switchAuthTab = (tab) => {
                document.querySelectorAll('.auth-tab').forEach(t=>t.classList.remove('active'));
                document.querySelectorAll('.auth-form').forEach(f=>f.classList.remove('active'));
                if(tab==='login') {
                    document.querySelector('[onclick="switchAuthTab(\'login\')"]').classList.add('active');
                    document.getElementById('login-form').classList.add('active');
                } else {
                    document.querySelector('[onclick="switchAuthTab(\'register\')"]').classList.add('active');
                    document.getElementById('register-form').classList.add('active');
                }
            };
            window.handleRegister = () => {
                const name = document.getElementById('register-name').value.trim();
                const email = document.getElementById('register-email').value.trim();
                const pwd = document.getElementById('register-password').value;
                const err = document.getElementById('register-error');
                if(!name||!email||!pwd) { err.textContent='‚ö†Ô∏è All fields required'; return; }
                if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { err.textContent='‚ö†Ô∏è Invalid email'; return; }
                if(pwd.length<6) { err.textContent='‚ö†Ô∏è Password min 6 chars'; return; }
                const users = JSON.parse(localStorage.getItem('users')||'[]');
                if(users.find(u=>u.email===email)) { err.textContent='‚ö†Ô∏è User exists'; return; }
                const newUser={name,email,password:pwd};
                users.push(newUser);
                localStorage.setItem('users',JSON.stringify(users));
                currentUser=newUser;
                localStorage.setItem('currentUser',JSON.stringify(newUser));
                showNotification('‚ú® Registration successful!');
                showMainApp();
            };
            window.handleLogin = () => {
                const email = document.getElementById('login-email').value.trim();
                const pwd = document.getElementById('login-password').value;
                const err = document.getElementById('login-error');
                if(!email||!pwd) { err.textContent='‚ö†Ô∏è All fields required'; return; }
                const users = JSON.parse(localStorage.getItem('users')||'[]');
                const user = users.find(u=>u.email===email && u.password===pwd);
                if(!user) { err.textContent='‚ö†Ô∏è Invalid email/password'; return; }
                currentUser=user;
                localStorage.setItem('currentUser',JSON.stringify(user));
                showNotification(`üéâ Welcome back, ${user.name}!`);
                showMainApp();
            };
            window.handleLogout = () => {
                currentUser=null;
                localStorage.removeItem('currentUser');
                document.getElementById('auth-section').style.display='flex';
                document.getElementById('main-app').style.display='none';
                audio.pause(); isPlaying=false;
                showNotification('üëã Logged out');
            };
            function showMainApp() {
                document.getElementById('auth-section').style.display='none';
                document.getElementById('main-app').style.display='block';
                document.getElementById('welcome-user').textContent = `Welcome, ${currentUser.name}! ‚ú®`;
                loadUserData();
                renderSongs();
                updateStats();
            }

            // render functions (unchanged, but using SONGS)
            function renderSongs() {
                const container = document.getElementById('songs-container');
                const filtered = SONGS.filter(s=> s.title.toLowerCase().includes(searchQuery.toLowerCase()) || s.artist.toLowerCase().includes(searchQuery.toLowerCase()));
                if(!filtered.length) { container.innerHTML='<div class="no-lyrics">üîç No songs found</div>'; return; }
                container.innerHTML = filtered.map(song=>{
                    const origIdx = SONGS.findIndex(s=>s.filename===song.filename);
                    return `<div class="song-card ${origIdx===currentSongIndex&&isPlaying?'playing':''}" data-song-index="${origIdx}" onclick="playSong(${origIdx})"><div class="song-thumbnail" style="background-image: url('${song.thumbnail}')"><div class="play-overlay"><span>‚ñ∂Ô∏è</span></div></div><div class="song-title">${song.title}</div><div class="song-artist">${song.artist}</div><div class="song-actions"><button class="song-btn" onclick="event.stopPropagation(); addToPlaylist(${origIdx})">Add</button><button class="song-btn secondary" onclick="event.stopPropagation(); toggleOffline(${origIdx})">Save</button></div></div>`;
                }).join('');
            }
            window.searchSongs = (q) => { searchQuery=q; renderSongs(); };
            window.showAllSongs = () => { searchQuery=''; document.getElementById('search-input').value=''; renderSongs(); showNotification('Showing all songs'); };

            // playlist & offline (identical)
            window.addToPlaylist = (idx) => {
                let pl = JSON.parse(localStorage.getItem(`playlist_${currentUser.email}`)||'[]');
                if(!pl.includes(idx)) { pl.push(idx); localStorage.setItem(`playlist_${currentUser.email}`,JSON.stringify(pl)); renderPlaylist(); showNotification('‚ûï Added to playlist'); }
                else showNotification('‚ö†Ô∏è Already in playlist');
            };
            window.removeFromPlaylist = (idx) => {
                let pl = JSON.parse(localStorage.getItem(`playlist_${currentUser.email}`)||'[]');
                pl = pl.filter(i=>i!==idx);
                localStorage.setItem(`playlist_${currentUser.email}`,JSON.stringify(pl)); renderPlaylist(); showNotification('‚ûñ Removed');
            };
            function renderPlaylist() {
                const container = document.getElementById('playlist-container');
                const pl = JSON.parse(localStorage.getItem(`playlist_${currentUser.email}`)||'[]');
                if(!pl.length) { container.innerHTML='<div class="no-lyrics">‚ú® Your playlist is empty ‚ú®</div>'; return; }
                container.innerHTML = pl.map(idx=>{
                    const s=SONGS[idx];
                    return `<div class="song-card ${idx===currentSongIndex&&isPlaying?'playing':''}" onclick="playSong(${idx})"><div class="song-thumbnail" style="background-image: url('${s.thumbnail}')"><div class="play-overlay"><span>‚ñ∂Ô∏è</span></div></div><div class="song-title">${s.title}</div><div class="song-artist">${s.artist}</div><button class="song-btn" onclick="event.stopPropagation(); removeFromPlaylist(${idx})">Remove</button></div>`;
                }).join('');
            }
            window.showAllPlaylist = () => { let p=JSON.parse(localStorage.getItem(`playlist_${currentUser.email}`)||'[]'); showNotification(p.length?`You have ${p.length} songs`:'Empty playlist'); };
            window.toggleOffline = (idx) => {
                let off = JSON.parse(localStorage.getItem(`offline_${currentUser.email}`)||'[]');
                if(off.includes(idx)) { off = off.filter(i=>i!==idx); showNotification('üì¥ Removed offline'); } 
                else { off.push(idx); showNotification('üì≤ Saved offline'); }
                localStorage.setItem(`offline_${currentUser.email}`,JSON.stringify(off));
                renderOfflineSongs();
            };
            function renderOfflineSongs() {
                const container = document.getElementById('offline-container');
                const off = JSON.parse(localStorage.getItem(`offline_${currentUser.email}`)||'[]');
                if(!off.length) { container.innerHTML='<div class="no-lyrics">‚ú® No songs saved offline ‚ú®</div>'; return; }
                container.innerHTML = off.map(idx=>{
                    const s=SONGS[idx];
                    return `<div class="song-card ${idx===currentSongIndex&&isPlaying?'playing':''}" onclick="playSong(${idx})"><div class="song-thumbnail" style="background-image: url('${s.thumbnail}')"><div class="play-overlay"><span>‚ñ∂Ô∏è</span></div></div><div class="song-title">${s.title}</div><div class="song-artist">${s.artist}</div><button class="song-btn secondary" onclick="event.stopPropagation(); toggleOffline(${idx})">Remove</button></div>`;
                }).join('');
            }
            window.showAllOffline = () => { let o=JSON.parse(localStorage.getItem(`offline_${currentUser.email}`)||'[]'); showNotification(o.length?`${o.length} offline songs`:'No offline songs'); };

            // stats
            function updateListeningStats(songIndex) {
                let stats = JSON.parse(localStorage.getItem(`stats_${currentUser.email}`)||'{"totalListens":0,"artistPlays":{},"listeningTime":0}');
                stats.totalListens++;
                stats.artistPlays[SONGS[songIndex].artist] = (stats.artistPlays[SONGS[songIndex].artist]||0)+1;
                localStorage.setItem(`stats_${currentUser.email}`,JSON.stringify(stats));
                updateStats();
            }
            function updateStats() {
                let stats = JSON.parse(localStorage.getItem(`stats_${currentUser.email}`)||'{"totalListens":0,"artistPlays":{},"listeningTime":0}');
                document.getElementById('total-listens').textContent = stats.totalListens;
                document.getElementById('listening-time').textContent = Math.floor(stats.listeningTime/60)+' min';
                let most='-', max=0;
                Object.entries(stats.artistPlays).forEach(([a,p])=>{if(p>max){max=p;most=a;}});
                document.getElementById('most-played-artist').textContent=most;
                let sorted = Object.entries(stats.artistPlays).sort((a,b)=>b[1]-a[1]);
                let rankEl = document.getElementById('artist-ranking');
                if(!sorted.length) rankEl.innerHTML='<div class="no-lyrics">‚ú® No stats yet ‚ú®</div>';
                else rankEl.innerHTML = sorted.map(([a,p])=>`<div class="artist-item"><span>üé§ ${a}</span><span>${p} plays</span></div>`).join('');
            }
            function loadUserData(){ renderPlaylist(); renderOfflineSongs(); updateStats(); }

            // audio controls
            window.playSong = (index) => {
                if(!currentUser) return;
                currentSongIndex = index;
                const song = SONGS[index];
                audio.src = `music/${song.filename}`;
                audio.load();
                audio.play().then(()=>{
                    isPlaying=true;
                    document.getElementById('play-pause-btn').innerHTML='‚è∏Ô∏è';
                    document.getElementById('current-song-title').textContent=song.title;
                    document.getElementById('current-song-artist').textContent=song.artist;
                    if(showLyrics) { renderLyrics(); startLyricsSync(); }
                    renderSongs(); renderPlaylist(); renderOfflineSongs();
                    showNotification(`üéµ Now playing: ${song.title}`);
                    updateListeningStats(index);
                }).catch(e=>showNotification('‚ö†Ô∏è Audio file not found. Place MP3 in music/ folder.'));
            };
            window.togglePlay = () => {
                if(!audio.src) return;
                if(isPlaying) { audio.pause(); isPlaying=false; document.getElementById('play-pause-btn').innerHTML='‚ñ∂Ô∏è'; stopLyricsSync(); }
                else { audio.play(); isPlaying=true; document.getElementById('play-pause-btn').innerHTML='‚è∏Ô∏è'; startLyricsSync(); }
            };
            window.playNext = () => {
                let next;
                if(shuffleMode) { do{ next = Math.floor(Math.random()*SONGS.length); }while(next===currentSongIndex && SONGS.length>1); }
                else { next = (currentSongIndex+1)%SONGS.length; }
                playSong(next);
            };
            window.playPrevious = () => {
                let prev = (currentSongIndex-1+SONGS.length)%SONGS.length;
                playSong(prev);
            };
            window.toggleShuffle = () => { shuffleMode=!shuffleMode; document.getElementById('shuffle-btn').style.color=shuffleMode?'var(--accent-primary)':''; showNotification(`üîÄ Shuffle ${shuffleMode?'ON':'OFF'}`); };
            window.toggleRepeat = () => { repeatMode=!repeatMode; document.getElementById('repeat-btn').style.color=repeatMode?'var(--accent-primary)':''; showNotification(`üîÅ Repeat ${repeatMode?'ON':'OFF'}`); };
            window.changeVolume = (v) => { audio.volume = v/100; };
            window.seekTo = (e) => {
                if(!audio.duration) return;
                const rect = e.currentTarget.getBoundingClientRect();
                const pos = (e.clientX - rect.left)/rect.width;
                audio.currentTime = pos * audio.duration;
            };
            audio.addEventListener('timeupdate', ()=>{
                if(audio.duration){
                    const prog = (audio.currentTime/audio.duration)*100;
                    document.getElementById('progress-bar').style.width = prog+'%';
                    document.getElementById('current-time').textContent = formatTime(audio.currentTime);
                    document.getElementById('duration').textContent = formatTime(audio.duration);
                }
            });
            audio.addEventListener('ended', ()=>{
                if(repeatMode) { audio.currentTime=0; audio.play(); }
                else { playNext(); }
            });
            audio.addEventListener('loadedmetadata', ()=>{
                document.getElementById('duration').textContent = formatTime(audio.duration);
            });
            function formatTime(sec){ if(isNaN(sec)) return '0:00'; let m=Math.floor(sec/60); let s=Math.floor(sec%60); return m+':'+s.toString().padStart(2,'0'); }

            // lyrics sync
            function renderLyrics(){
                let c=document.getElementById('lyrics-container');
                let s=SONGS[currentSongIndex];
                if(!s.lyrics||!s.lyrics.length){ c.innerHTML='<div class="no-lyrics">‚ú® No lyrics available ‚ú®</div>'; return; }
                c.innerHTML = s.lyrics.map(l=>`<div class="lyric-line" data-time="${l.time}" onclick="seekToLyric(${l.time})">${l.text}</div>`).join('');
            }
            window.seekToLyric = (t) => { audio.currentTime = t; if(!isPlaying) audio.play(); };
            function startLyricsSync(){
                stopLyricsSync();
                lyricsUpdateInterval = setInterval(()=>{
                    if(!showLyrics||!audio.duration) return;
                    let ct = audio.currentTime;
                    let lines = document.querySelectorAll('.lyric-line');
                    let song=SONGS[currentSongIndex];
                    if(!song.lyrics) return;
                    let activeIdx=-1;
                    for(let i=song.lyrics.length-1;i>=0;i--){ if(ct>=song.lyrics[i].time){ activeIdx=i; break; } }
                    lines.forEach((l,i)=>{ if(i===activeIdx){ l.classList.add('active'); l.scrollIntoView({behavior:'smooth',block:'center'}); } else l.classList.remove('active'); });
                },100);
            }
            function stopLyricsSync(){ if(lyricsUpdateInterval) clearInterval(lyricsUpdateInterval); }
            window.toggleLyrics = ()=>{
                showLyrics=!showLyrics;
                let sec = document.getElementById('lyrics-section');
                let btn = document.getElementById('lyrics-toggle-btn');
                if(showLyrics){ sec.style.display='block'; btn.innerHTML='<span>üìú</span> Hide Lyrics'; btn.classList.add('active'); renderLyrics(); if(isPlaying) startLyricsSync(); }
                else { sec.style.display='none'; btn.innerHTML='<span>üìú</span> Show Lyrics'; btn.classList.remove('active'); stopLyricsSync(); }
            };
            window.toggleTheme = () => {
                let html = document.documentElement;
                let cur = html.getAttribute('data-theme')||'dark';
                let nxt = cur==='dark'?'light':'dark';
                html.setAttribute('data-theme',nxt); localStorage.setItem('theme',nxt); showNotification(`üé® ${nxt} mode`);
            };
            function showNotification(msg) {
                const n = document.createElement('div');
                n.className = 'notification';
                n.innerHTML = `<span>‚ú®</span> ${msg}`;
                document.body.appendChild(n);
                setTimeout(() => { n.style.animation = 'notificationSlide 0.5s reverse'; setTimeout(() => n.remove(), 400); }, 3000);
            }

            // init
            (function init(){
                let theme = localStorage.getItem('theme');
                if(theme) document.documentElement.setAttribute('data-theme',theme);
                let saved = localStorage.getItem('currentUser');
                if(saved){ currentUser=JSON.parse(saved); showMainApp(); }
                setInterval(()=>{
                    if(currentUser && isPlaying){
                        let stats = JSON.parse(localStorage.getItem(`stats_${currentUser.email}`)||'{"totalListens":0,"artistPlays":{},"listeningTime":0}');
                        stats.listeningTime++;
                        localStorage.setItem(`stats_${currentUser.email}`,JSON.stringify(stats));
                        updateStats();
                    }
                },1000);
                audio.volume = 0.7;
            })();
        })();
    </script>
</body>
</html>